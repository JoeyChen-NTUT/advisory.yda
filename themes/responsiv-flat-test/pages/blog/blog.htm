title = "Blog"
url = "/blog/:slug?"
layout = "default"
description = "Viewing a single blog post"
is_hidden = 0
robot_index = "index"
robot_follow = "follow"

[blogPosts]
pageNumber = "{{ :page }}"
postsPerPage = 1000000000000
noPostsMessage = "No posts found"
sortOrder = "published_at desc"
categoryPage = "blog/category"
postPage = "blog/post"

[blogCategories]
slug = "{{ :slug }}"
displayEmpty = 0
categoryPage = "blog/category"

[searchForm]
resultPage = 404
categoryFilter = 0

[blogTags]
results = 0
direction = "desc"

[searchResults]
resultsPerPage = 10
showProviderBadge = 1
noResultsMessage = "Your search returned no results."
visitPageMessage = "Visit page"

[siteSearchInclude]

[PostList]
use_authors = 1
restrict_owner = 1
formPage = "blog/post"
==
<?php
function onStart()
{   
    $this->addCss('assets/css/tree.css');
    
}
?>
==
<link href="{{ 'assets/css/home/fields.css'|theme }}" rel="stylesheet">
{% put scripts %}
    <script src="{{ [
        'assets/vendor/isotope/jquery.isotope.js',
        'assets/javascript/pages/portfolio.js',
    ]|theme }}"></script>
{% endput %}

<!-- 文字雲JS end -->



    <div class="row"style="margin-right:0;margin-left:0;">
   <!-- 文字雲2 -->

            <section class="fields">
                  <div class="row"style="margin-right:0px;">
                 <div class="col-sm-12">
                 
                        <h2 class="headline">
                            <span>我們關心的領域</span>
                        </h2>
                       
                       {% partial 'tagcloud' %} 
                     
                        </div>
                    
                       
              </div>
            </section>



 <link href="{{ 'assets/css/user/track.css'|theme }}" rel="stylesheet">
    <section id="track" class="container">
    <div class="row">
        <h4 class="headline">
            <span>委員 Tracks</span>
        </h4>
    </div>
    
      <div class="row"> 
        <!-- 搜詢 --> 
      <div  class="container">
      <div class="row">

      <div class="col-sm-6 col-sm-offset-3">
<form  method="GET" action="{{ Blog.resultPage|page }}">
     <div class="input-group stylish-input-group">
        <input type="text" class="form-control" name="search" class="form-control" placeholder="輸入關鍵字搜尋">
    
        {% if __SELF__.categoryFilter %}
            <select name="cat[]" class="form-control">
            {% for key,cat in Blog.categories %}
                <option value="{{ key }}">{{ cat }}</option>
            {% endfor %}
            </select>
        {% endif %}
        <span class="input-group-addon">
        <button  type="submit"><span class="glyphicon glyphicon-search">{{ ''|_ }}</span></button>
        </span>    
    </div>
</form>
</div>
</div>
</div>
</div>
      </br>
      <body bgcolor="black" text="white" link="#00ffff" vlink="green" alink="yellow">
<!-- Blog呈現 -->
    <div class="row">
        <div class="container">
            <div class="col-md-12">
                <ul class="timeline" id="timeline_head"></ul>
            </div>
<script>
    var newpost = [];
    var ul = document.getElementById('timeline_head');
    var li;
    var date;
    
    var timeline_i = 0;    
    var clientId = ; //choose web app client Id, redirect URI and Javascript origin set to http://localhost
    var apiKey = ; //choose public apiKey, any IP allowed (leave blank the allowed IP boxes in Google Dev Console)
    var userEmail = ; //your calendar Id
    var userTimeZone = "Taipei"; //example "Rome" "Los_Angeles" ecc...
    var maxRows = 10; //events to shown
    var calName = "YOUR CALENDAR NAME"; //name of calendar (write what you want, doesn't matter)
    var scopes = 'https://www.googleapis.com/auth/calendar';  
    
    //--------------------- num Month to String
    function monthString(num) {
             if (num === "01") { return "1"; } 
        else if (num === "02") { return "2"; } 
        else if (num === "03") { return "3"; } 
        else if (num === "04") { return "4"; } 
        else if (num === "05") { return "5"; } 
        else if (num === "06") { return "6"; } 
        else if (num === "07") { return "7"; } 
        else if (num === "08") { return "8"; } 
        else if (num === "09") { return "9"; } 
        else if (num === "10") { return "10"; } 
        else if (num === "11") { return "11"; } 
        else if (num === "12") { return "12"; }
    }
    //--------------------- end
    
    //--------------------- client CALL
    function handleClientLoad() {
        gapi.client.setApiKey(apiKey);
        checkAuth();
    }
    //--------------------- end
    
    //--------------------- check Auth
    function checkAuth() {
        gapi.auth.authorize({client_id: clientId, scope: scopes, immediate: true}, handleAuthResult);
    }
    //--------------------- end
    
    //--------------------- handle result and make CALL
    function handleAuthResult(authResult) {
        if (authResult) {
            makeApiCall();
        }
    }
    //--------------------- end
    
    //--------------------- API CALL itself
    function makeApiCall() {
        var today = new Date(); //today date
        gapi.client.load('calendar', 'v3', function () {
            var request = gapi.client.calendar.events.list({
                'calendarId' : userEmail,
                'timeZone' : userTimeZone, 
                'singleEvents': true, 
                'timeMin': today.toISOString(), //gathers only events not happened yet
                'maxResults': maxRows, 
                'q': '#青諮會網站',
                'orderBy': 'startTime'});
            
            request.execute(function (resp) {
                for (var i = resp.items.length - 1; i >= 0; i--) {
                    var item = resp.items[i];
                    var allDay = item.start.date? true : false;
                    var startDT = allDay ? item.start.date : item.start.dateTime;
                    var dateTime = startDT.split("T"); //split date from time
                    var date = dateTime[0].split("-"); //split yyyy mm dd
                    var startYear = date[0];
                    var startMonth = monthString(date[1]);
                    var startDay = date[2];
                    
                    li = document.createElement('li');
                    if(i % 2 == 0)
                        li.classList.add("timeline-inverted");
                    li.innerHTML =
                        '<div class="timeline-panel" data-toggle="modal" data-target="#meeting-Modal">'
                            + '<div class="timeline-body">'
                                + '<h4>' + item.summary + '</h4>'
                            + '</div>'
                        + '</div>'
                        + '<div class="avatars">'
                            + '<div class="col-md-12">'
                                + '<div class="timeline-date">'
                                    + startYear+'/' + startMonth + '/' + startDay
                                + '</div>'
                             + '</div>'
                        + '</div>';
                    ul.appendChild(li);
                }
                timeline_i = resp.items.length;
                renderPost();
            });
        });
    }
    //--------------------- end
        
    function renderPost() {
        {% for post in posts if post.categories[0].id != 1 %}
            var postObject = {};
            postObject.id = "{{post.id}}";
            postObject.url = "{{post.url}}";
            postObject.title = "{{post.title}}";
            postObject.tagNames = [];
            {% for tag in post.tags %}
                postObject.tagNames.push("{{tag.name}}");
            {% endfor %}
            postObject.getUsers = [];
            {% for user in post.getUsers %}
                var user = {};
                user.avatar = {};
                user.avatar.path = "{{user.avatar.path}}";
                user.id = "{{user.id}}";
                postObject.getUsers.push(user);
            {% endfor %}
            postObject.published_at = "{{post.published_at}}";
            newpost.push(postObject);
        {% endfor %}
        
        for(var i=timeline_i; i < newpost.length; ++i){
            var post = newpost[i];
            var tagString = "";
            var avatarString = "";
            for(var j = 0; j < post.tagNames.length; ++j) {
                var tagName = post.tagNames[j];
                tagString += 
                        '<a href="{{ 'blog/tag'|page }}/' + tagName + '" class="pull-right">'
                            + '<span class="label label-success">' + tagName + '</span>'
                        + '</a>';
            }
            {% for post in posts if post.categories[0].id != 1 %}
                if(post.id == {{post.id}}) {
                    {% for user in post.getUsers %}
                        avatarString += '<a href="{{ 'test/userpost'|page({ id:user.id }) }}">';
                        {% if  user.avatar.path|length!=0%}
                            avatarString += '<div class="avatar" style="background:url(\'{{user.avatar.path}}\');">';
                        {%else%}
                            avatarString += '<div class="avatar" style="background:url(\'{{'assets/images/users/nopicture.jpg'|theme}}\');">';
                        {% endif %}
                            avatarString += '</div>';
                        avatarString += '</a>';
                    {% endfor %}
                }
            {% endfor %}
            date=new Date(post.published_at.replace(/-/g,'/'));
            li = document.createElement('li');
            if(i % 2 == 0)
                li.classList.add("timeline-inverted");
            li.innerHTML =
                '<div class="timeline-panel" data-toggle="modal" data-target="#meeting-Modal" onclick="window.location=\'' + post.url + '\';">'
                    + '<div class="timeline-body">'
                        + '<h4><a href="' + post.url + '">' + post.title + '</a></h4>'
                    + '</div>'
                    + '<div class="timeline-footer">'
                        + tagString
                    + '</div>'
                + '</div>';
            // li.innerHTML += '<div class="avatars" style="margin-right: 50px">'
            li.innerHTML += '<div class="avatars">'
                 +'<div class="col-md-12">'
                        // + '<div class="timeline-date" style="margin-right: 10%;">'
                        + '<div class="timeline-date">'
                        + date.getFullYear()+'/' + (date.getMonth()+1)+ '/'+date.getDate()
                        
                    + '</div>'
                    + avatarString
                    
                 + '</div>'
            
                + '</div>';
            ul.appendChild(li);
        }
        li = document.createElement('li');
        li.classList.add('clearfix');
        li.style.float = 'none';
        ul.appendChild(li);
    }
</script>
<script src='https://apis.google.com/js/client.js?onload=handleClientLoad'></script>
        </div>
    </div>
</section>